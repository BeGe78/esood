<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: index
  
    &mdash; Documentation by YARD 0.9.2
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "index";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: index</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="file_list.html"></iframe>

      <div id="content"><div id='filecontents'><!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Rr</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.0/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.0/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.0/favicon_yellow.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.0/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.0/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2016-08-02T14:29:36+02:00">2016-08-02T14:29:36+02:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="yellow">83.21%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         47.72
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>22</b> files in total.
    <b>530</b> relevant lines. 
    <span class="green"><b>441</b> lines covered</span> and
    <span class="red"><b>89</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#9363e5fc3299862e16979a7c7398a209083e0705" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
        <td class="yellow strong">88.89 %</td>
        <td>45</td>
        <td>18</td>
        <td>16</td>
        <td>2</td>
        <td>209.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f7a90ac56a68a928db4745fe7b8d5e82241f780e" class="src_link" title="app/controllers/countries_controller.rb">app/controllers/countries_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>67</td>
        <td>28</td>
        <td>28</td>
        <td>0</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fef1cc385131a02b9b651abc6aea62ff94dbc545" class="src_link" title="app/controllers/indicators_controller.rb">app/controllers/indicators_controller.rb</a></td>
        <td class="green strong">97.14 %</td>
        <td>93</td>
        <td>35</td>
        <td>34</td>
        <td>1</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#94c9de16edbad2e26b34a4d68d3ea6d474956785" class="src_link" title="app/controllers/invoicing_ledger_items_controller.rb">app/controllers/invoicing_ledger_items_controller.rb</a></td>
        <td class="green strong">91.67 %</td>
        <td>45</td>
        <td>12</td>
        <td>11</td>
        <td>1</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#863b5846f87e28b080f45f43d51e69dcf825f1f2" class="src_link" title="app/controllers/plans_controller.rb">app/controllers/plans_controller.rb</a></td>
        <td class="green strong">95.24 %</td>
        <td>79</td>
        <td>21</td>
        <td>20</td>
        <td>1</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7634ce5face526954200be5a5274eae6da322d07" class="src_link" title="app/controllers/registrations_controller.rb">app/controllers/registrations_controller.rb</a></td>
        <td class="red strong">10.67 %</td>
        <td>155</td>
        <td>75</td>
        <td>8</td>
        <td>67</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d9378aacd2661f399cb0d794c399a9e908c90d70" class="src_link" title="app/controllers/roles_controller.rb">app/controllers/roles_controller.rb</a></td>
        <td class="green strong">95.45 %</td>
        <td>80</td>
        <td>22</td>
        <td>21</td>
        <td>1</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#719a452ca7de5e2350f2a356737387172a98c1a5" class="src_link" title="app/controllers/selectors_controller.rb">app/controllers/selectors_controller.rb</a></td>
        <td class="green strong">92.52 %</td>
        <td>255</td>
        <td>147</td>
        <td>136</td>
        <td>11</td>
        <td>51.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d3c729b708c3670089183604fbe4b55ebc5a1c76" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
        <td class="yellow strong">88.46 %</td>
        <td>86</td>
        <td>26</td>
        <td>23</td>
        <td>3</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b68eac321c0b040bd21e477511d0f3b7b0c8a05f" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f9c937155ee5a5c2aead667d89d3af63fcc352c4" class="src_link" title="app/helpers/selectors_helper.rb">app/helpers/selectors_helper.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>16</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>180.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3b31ac6d7aa4680df717e38794549ff067ad7f1e" class="src_link" title="app/helpers/stripe_helper.rb">app/helpers/stripe_helper.rb</a></td>
        <td class="green strong">98.21 %</td>
        <td>125</td>
        <td>56</td>
        <td>55</td>
        <td>1</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b456b8f40eaa9327fbd038a8c89470b2a435e06d" class="src_link" title="app/mailers/my_mailer.rb">app/mailers/my_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>29</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>34.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a854e8c6b899da7d81d58afabf9b962364614950" class="src_link" title="app/mailers/user_mailer.rb">app/mailers/user_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>44</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#262043dcc7cd869b211ca1cdc878101fae1ae3cc" class="src_link" title="app/models/ability.rb">app/models/ability.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>49</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>412.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aba016f201dd543f8c05c9dfb24fe93ed5839b2a" class="src_link" title="app/models/country.rb">app/models/country.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bbaa9c778a1095e9ab03dc92f21ac8dccdb82441" class="src_link" title="app/models/indicator.rb">app/models/indicator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fd5776f15d1f5ec5a9cc2d52314025a7ce220f53" class="src_link" title="app/models/invoicing_ledger_item.rb">app/models/invoicing_ledger_item.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#adb4354c30635c965242a8908985c49c15c9d6ed" class="src_link" title="app/models/plan.rb">app/models/plan.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ced499ce880243f7497455834b540e44e767ca49" class="src_link" title="app/models/role.rb">app/models/role.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7c21540fe1a6981e554423d8a7f8325720060f7b" class="src_link" title="app/models/selector.rb">app/models/selector.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4ad2671417f75bde415b170275993a4f54a7eb0a" class="src_link" title="app/models/user.rb">app/models/user.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>431.7</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
          <div class="file_list_container" id="Controllers">
  <h2>
    <span class="group_name">Controllers</span>
    (<span class="covered_percent"><span class="red">77.34%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         29.85
       </span>
    </span> hits/line)
  </h2>
  <a name="Controllers"></a>
  <div>
    <b>9</b> files in total.
    <b>384</b> relevant lines. 
    <span class="green"><b>297</b> lines covered</span> and
    <span class="red"><b>87</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#9363e5fc3299862e16979a7c7398a209083e0705" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
        <td class="yellow strong">88.89 %</td>
        <td>45</td>
        <td>18</td>
        <td>16</td>
        <td>2</td>
        <td>209.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f7a90ac56a68a928db4745fe7b8d5e82241f780e" class="src_link" title="app/controllers/countries_controller.rb">app/controllers/countries_controller.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>67</td>
        <td>28</td>
        <td>28</td>
        <td>0</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fef1cc385131a02b9b651abc6aea62ff94dbc545" class="src_link" title="app/controllers/indicators_controller.rb">app/controllers/indicators_controller.rb</a></td>
        <td class="green strong">97.14 %</td>
        <td>93</td>
        <td>35</td>
        <td>34</td>
        <td>1</td>
        <td>1.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#94c9de16edbad2e26b34a4d68d3ea6d474956785" class="src_link" title="app/controllers/invoicing_ledger_items_controller.rb">app/controllers/invoicing_ledger_items_controller.rb</a></td>
        <td class="green strong">91.67 %</td>
        <td>45</td>
        <td>12</td>
        <td>11</td>
        <td>1</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#863b5846f87e28b080f45f43d51e69dcf825f1f2" class="src_link" title="app/controllers/plans_controller.rb">app/controllers/plans_controller.rb</a></td>
        <td class="green strong">95.24 %</td>
        <td>79</td>
        <td>21</td>
        <td>20</td>
        <td>1</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7634ce5face526954200be5a5274eae6da322d07" class="src_link" title="app/controllers/registrations_controller.rb">app/controllers/registrations_controller.rb</a></td>
        <td class="red strong">10.67 %</td>
        <td>155</td>
        <td>75</td>
        <td>8</td>
        <td>67</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d9378aacd2661f399cb0d794c399a9e908c90d70" class="src_link" title="app/controllers/roles_controller.rb">app/controllers/roles_controller.rb</a></td>
        <td class="green strong">95.45 %</td>
        <td>80</td>
        <td>22</td>
        <td>21</td>
        <td>1</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#719a452ca7de5e2350f2a356737387172a98c1a5" class="src_link" title="app/controllers/selectors_controller.rb">app/controllers/selectors_controller.rb</a></td>
        <td class="green strong">92.52 %</td>
        <td>255</td>
        <td>147</td>
        <td>136</td>
        <td>11</td>
        <td>51.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d3c729b708c3670089183604fbe4b55ebc5a1c76" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
        <td class="yellow strong">88.46 %</td>
        <td>86</td>
        <td>26</td>
        <td>23</td>
        <td>3</td>
        <td>1.2</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Models">
  <h2>
    <span class="group_name">Models</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         226.35
       </span>
    </span> hits/line)
  </h2>
  <a name="Models"></a>
  <div>
    <b>8</b> files in total.
    <b>54</b> relevant lines. 
    <span class="green"><b>54</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#262043dcc7cd869b211ca1cdc878101fae1ae3cc" class="src_link" title="app/models/ability.rb">app/models/ability.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>49</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>412.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aba016f201dd543f8c05c9dfb24fe93ed5839b2a" class="src_link" title="app/models/country.rb">app/models/country.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bbaa9c778a1095e9ab03dc92f21ac8dccdb82441" class="src_link" title="app/models/indicator.rb">app/models/indicator.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>14</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fd5776f15d1f5ec5a9cc2d52314025a7ce220f53" class="src_link" title="app/models/invoicing_ledger_item.rb">app/models/invoicing_ledger_item.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#adb4354c30635c965242a8908985c49c15c9d6ed" class="src_link" title="app/models/plan.rb">app/models/plan.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ced499ce880243f7497455834b540e44e767ca49" class="src_link" title="app/models/role.rb">app/models/role.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7c21540fe1a6981e554423d8a7f8325720060f7b" class="src_link" title="app/models/selector.rb">app/models/selector.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>6</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4ad2671417f75bde415b170275993a4f54a7eb0a" class="src_link" title="app/models/user.rb">app/models/user.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>431.7</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Mailers">
  <h2>
    <span class="group_name">Mailers</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         16.21
       </span>
    </span> hits/line)
  </h2>
  <a name="Mailers"></a>
  <div>
    <b>2</b> files in total.
    <b>29</b> relevant lines. 
    <span class="green"><b>29</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#b456b8f40eaa9327fbd038a8c89470b2a435e06d" class="src_link" title="app/mailers/my_mailer.rb">app/mailers/my_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>29</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>34.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a854e8c6b899da7d81d58afabf9b962364614950" class="src_link" title="app/mailers/user_mailer.rb">app/mailers/user_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>44</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Helpers">
  <h2>
    <span class="group_name">Helpers</span>
    (<span class="covered_percent"><span class="green">96.83%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         18.08
       </span>
    </span> hits/line)
  </h2>
  <a name="Helpers"></a>
  <div>
    <b>3</b> files in total.
    <b>63</b> relevant lines. 
    <span class="green"><b>61</b> lines covered</span> and
    <span class="red"><b>2</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#b68eac321c0b040bd21e477511d0f3b7b0c8a05f" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>3</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f9c937155ee5a5c2aead667d89d3af63fcc352c4" class="src_link" title="app/helpers/selectors_helper.rb">app/helpers/selectors_helper.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>16</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>180.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3b31ac6d7aa4680df717e38794549ff067ad7f1e" class="src_link" title="app/helpers/stripe_helper.rb">app/helpers/stripe_helper.rb</a></td>
        <td class="green strong">98.21 %</td>
        <td>125</td>
        <td>56</td>
        <td>55</td>
        <td>1</td>
        <td>1.0</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Jobs">
  <h2>
    <span class="group_name">Jobs</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line)
  </h2>
  <a name="Jobs"></a>
  <div>
    <b>0</b> files in total.
    <b>0.0</b> relevant lines. 
    <span class="green"><b>0.0</b> lines covered</span> and
    <span class="red"><b>0.0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
    </tbody>
  </table>
</div>

        
          <div class="file_list_container" id="Libraries">
  <h2>
    <span class="group_name">Libraries</span>
    (<span class="covered_percent"><span class="green">100.0%</span></span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line)
  </h2>
  <a name="Libraries"></a>
  <div>
    <b>0</b> files in total.
    <b>0.0</b> relevant lines. 
    <span class="green"><b>0.0</b> lines covered</span> and
    <span class="red"><b>0.0</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
    </tbody>
  </table>
</div>

        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.12.0 
        and simplecov-html v0.10.0<br/>
        using MiniTest
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="9363e5fc3299862e16979a7c7398a209083e0705">
  <div class="header">
    <h3>app/controllers/application_controller.rb</h3>
    <h4><span class="yellow">88.89 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Top application controller  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Prevent CSRF attacks by raising an exception.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Set language.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Configure permitted parameters for devise gem.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Require WorldBank for the others.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;9&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/application_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class ApplicationController &lt; ActionController::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;11&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  protect_from_forgery with: :exception  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;12&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  before_action :set_locale # language (en &amp; fr) initialisation&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  before_action :configure_permitted_parameters, if: :devise_controller? # parameters rights for devise  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;14&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  require &#39;world_bank&#39; # world bank API&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;15&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;16&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  protected&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Configure permitted parameters for devise gem registration and account update&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;19&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def configure_permitted_parameters # list authorised parameters for devise registration &amp; update&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;140&quot; data-linenumber=&quot;20&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;140&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    devise_parameter_sanitizer.permit(:sign_up) do |u|&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      u.permit({ roles: [] }, :email, :password, :password_confirmation, :current_password, :name, :stripe_card_token, :plan_id, :invoice_count, :exp_month, :exp_year, :remember_me, :company_name, :language)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;22&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;140&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;140&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    devise_parameter_sanitizer.permit(:account_update) do |u|&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;24&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      u.permit({ roles: [] }, :email, :password, :password_confirmation, :current_password, :name, :stripe_card_token, :plan_id, :invoice_count, :exp_month, :exp_year, :remember_me, :company_name, :language)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Set language from params or default&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;29&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [I18n.locale] which could be :en or :fr&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;30&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def set_locale&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;716&quot; data-linenumber=&quot;31&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;716&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    I18n.locale = params[:locale] || I18n.default_locale&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;32&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;33&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;34&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Set default url with language&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;35&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [I18n.locale] which could be :en or :fr&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;36&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def default_url_options&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2709&quot; data-linenumber=&quot;37&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2709&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    { locale: I18n.locale == I18n.default_locale ? nil : I18n.locale }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;38&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # rescue cancan denied access to flash error&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;41&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  rescue_from CanCan::AccessDenied do # error rescue for cancan role control&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;29&quot; data-linenumber=&quot;42&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;29&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    flash[:error] = t(&#39;access_denied&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;29&quot; data-linenumber=&quot;43&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;29&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    redirect_to root_url&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;45&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="f7a90ac56a68a928db4745fe7b8d5e82241f780e">
  <div class="header">
    <h3>app/controllers/countries_controller.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Handles the {Country **Country model**} as defined by for the WorldBank database.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Only writable by users with *admin* role. Readable by anyone but with limitation (visible=Y) for not logged users.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# This controller support full localization (routes, fields and data).  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {CountriesControllerTest Corresponding tests:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/countries_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class CountriesController &lt; ApplicationController # reserved to admin. Let create and list countries&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  load_and_authorize_resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Asks for new country (country code and language)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;13&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/countries/new(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path new_country&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def new &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;16&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country = Country.new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Fetch the country from WorldBank and save the new country in the database. Error messages are rescued to flash notices.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;22&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url POST(/:locale)/countries(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def create&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;24&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country = Country.new(country_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;25&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @id1 = params[:country][:id1]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;26&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @language = params[:country][:language]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;27&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @results = WorldBank::Country.find(@id1).language(@language).fetch # get WorldBank country by id and language&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;28&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country.id1 = @results.raw[&#39;id&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;29&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country.name = @results.raw[&#39;name&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;30&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country.iso2code = @results.raw[&#39;iso2Code&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;31&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country.code = @results.raw[&#39;id&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;32&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country.type = &#39;Pays&#39; if @language == &#39;fr&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;33&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country.type = &#39;Country&#39; if @language == &#39;en&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;34&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country.language = @language&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;35&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country.save&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;36&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    render plain: @country.inspect&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;37&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  rescue StandardError&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;38&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    flash[:notice] = &#39;Error creating country&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;39&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    redirect_to new_country_path&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;40&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    return&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays countries list with bootstrap table sortable format and filtered by ability and language. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # List is filtered by language and by ability&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;45&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;46&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/countries(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;47&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path countries&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;48&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def index&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;7&quot; data-linenumber=&quot;49&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;7&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country = Country.accessible_by(current_ability).where(language: I18n.locale).order(:type, :name).all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;50&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;51&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;52&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the country &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;53&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [show.html.erb] the show web page. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;54&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/countries/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;55&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path country&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;56&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def show&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;57&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country = Country.find(params[:id])&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;58&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;59&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;60&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  private&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;61&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;62&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Use callbacks to share common setup or constraints between actions.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;63&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Never trust parameters from the scary internet, only allow the white list through.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;64&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def country_params&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;65&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    params.require(:country).permit(:id1)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;66&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end       &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;67&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end   &lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="fef1cc385131a02b9b651abc6aea62ff94dbc545">
  <div class="header">
    <h3>app/controllers/indicators_controller.rb</h3>
    <h4><span class="green">97.14 %</span> covered</h4>
    <div>
      <b>35</b> relevant lines. 
      <span class="green"><b>34</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Handles the {Indicator **Indicator model**} as defined by for the WorldBank database.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Only writable by users with *admin* role. Readable by anyone but with limitation (visible=Y) for not logged users.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# This controller support full localization (routes, fields and data).&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {IndicatorsControllerTest Corresponding tests:}&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/indicators_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class IndicatorsController &lt; ApplicationController&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  load_and_authorize_resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Asks for new indicator (indicator id and language)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;13&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/indicators/new(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path new_indicator&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;16&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator = Indicator.new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Fetch the indicator from WorldBank and save the new indicator in the database. Error messages are rescued to flash notices.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;22&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url POST(/:locale)/indicators(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def create&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;24&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator = Indicator.new(indicator_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;25&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @id1 = params[:indicator][:id1]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;26&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @language = params[:indicator][:language]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;27&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @results = WorldBank::Indicator.find(@id1).language(@language).fetch # get WorldBank indicator by id and language&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;28&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator.id1 = @results.raw[&#39;id&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;29&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator.name = @results.raw[&#39;name&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;30&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator.note = @results.raw[&#39;sourceNote&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;31&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator.language = @language&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;32&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator.source = @results.raw[&#39;source&#39;][&#39;value&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;33&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator.topic = @results.raw[&#39;topics&#39;].first[&#39;value&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;34&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator.save&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;35&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    render plain: @indicator.inspect &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;36&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  rescue StandardError&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;37&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    flash[:notice] = &#39;Error creating indicator&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;38&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    redirect_to new_indicator_path&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;39&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    return&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays indicators list with bootstrap table sortable format and filtered by ability and language. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # List is filtered by language and by ability&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;45&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/indicators(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;46&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path indicators&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;47&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def index&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;7&quot; data-linenumber=&quot;48&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;7&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator = Indicator.accessible_by(current_ability).where(language: I18n.locale).order(:topic, :id1).all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;49&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;50&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;51&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the indicator &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;52&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [show.html.erb] the show web page. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;53&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/indicators/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;54&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path indicator&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;55&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def show&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;56&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator = Indicator.find(params[:id])&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;57&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;58&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;59&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the indicator to be modified&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;60&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [edit.html.erb] the edit web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;61&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/indicators/:id/edit(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;62&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path edit_indicator&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;63&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def edit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;64&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;65&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;66&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Update the indicator in the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;67&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;68&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [edit.html.erb] the edit web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;69&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url PUT (/:locale)/indicators/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;70&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def update&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;71&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @indicator.update(indicator_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;72&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to @indicator, notice: &#39;Indicator was successfully updated.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;73&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;74&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      render :edit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;75&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;76&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;77&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;78&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Delete the indicator from the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;79&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;80&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url DELETE(/:locale)/indicators/:id(.:format)  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;81&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;82&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator.destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;83&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    redirect_to indicators_url, notice: &#39;Plan was successfully destroyed.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;84&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;85&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;86&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  private&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;87&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;88&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Use callbacks to share common setup or constraints between actions.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;89&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Never trust parameters from the scary internet, only allow the white list through.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;90&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def indicator_params&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;5&quot; data-linenumber=&quot;91&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;5&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    params.require(:indicator).permit(:id1, :name, :language, :topic, :note, :visible)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;92&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;93&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="94c9de16edbad2e26b34a4d68d3ea6d474956785">
  <div class="header">
    <h3>app/controllers/invoicing_ledger_items_controller.rb</h3>
    <h4><span class="green">91.67 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Handles **InvoicingLedgerItem model** as used by stripe and invoicing gems.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Only accessible by users with *admin* role. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# This controller support full localization (routes, fields and data).  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/invoicing_ledger_items_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;8&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class InvoicingLedgerItemsController &lt; ApplicationController&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  load_and_authorize_resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;10&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays invoicing_ledger_items list with bootstrap table sortable format.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # It is called with or without *recipient_id* param&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;13&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/invoicing_ledger_items(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path invoicing_ledger_items_list&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;15&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Index is called in two context: without param,  with one param&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;16&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def index&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;17&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @invoicing_ledger_items = params[:recipient_id].nil? ? InvoicingLedgerItem.all : InvoicingLedgerItem.where(recipient_id:  params[:recipient_id])&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the invoicing_ledger_item &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [show.html.erb] the show web page. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;22&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/invoicing_ledger_items/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;23&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path invoicing_ledger_item&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;24&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def show&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Delete the invoicing_ledger_item from the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;29&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url DELETE(/:locale)/invoicing_ledger_items/:id(.:format)  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;30&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # {InvoicingLedgerItemsControllerTest Corresponding tests:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;31&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;32&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @invoicing_ledger_item.destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;33&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    respond_to do |format|&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;34&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      format.html { redirect_to invoicing_ledger_items_url, notice: &#39;invoicing_ledger_item was successfully destroyed.&#39; }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;35&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;36&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;37&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;38&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  private&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Use callbacks to share common setup or constraints between actions.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Never trust parameters from the scary internet, only allow the white list through.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;42&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def invoicing_ledger_item_params&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    params.require(:invoicing_ledger_item).permit(:sender_id, :recipient_id)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;45&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="863b5846f87e28b080f45f43d51e69dcf825f1f2">
  <div class="header">
    <h3>app/controllers/plans_controller.rb</h3>
    <h4><span class="green">95.24 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Handles the {Plan **Plan model**} used by stripe for recurring billing.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Only accessible to users with *admin* role.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# The routes of this controller support localization but the web pages are not translated as it is used only by admin. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {PlansControllerTest Corresponding tests:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/plans_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class PlansController &lt; ApplicationController&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  load_and_authorize_resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Asks for new plan&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;13&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/plans/new(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path new_plan&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def new    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;16&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays plans list with bootstrap table sortable format&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/plans(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path plans&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;22&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def index&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @plans = Plan.all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;24&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the plan &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [show.html.erb] the show web page. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/plans/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;29&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path plan &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;30&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def show&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;31&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;32&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;33&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the plan to be modified&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;34&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [edit.html.erb] the edit web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;35&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/plans/:id/edit(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;36&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path edit_plan&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;37&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def edit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;38&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Save the new plan in the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url POST(/:locale)/plans(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;44&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def create&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;45&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @plan.save&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;46&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to @plan, notice: &#39;Plan was successfully created.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;47&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;48&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      render :new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;49&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;50&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;51&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;52&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Update the plan in the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;53&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;54&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [edit.html.erb] the edit web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;55&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url PUT (/:locale)/plans/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;56&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def update&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;57&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @plan.update(plan_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;58&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to @plan, notice: &#39;Plan was successfully updated.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;59&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;60&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      render :edit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;61&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;62&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;63&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;64&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Delete the plan from the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;65&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;66&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url DELETE(/:locale)/plans/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;67&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;68&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @plan.destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;69&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    redirect_to plans_url, notice: &#39;Plan was successfully destroyed.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;70&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;71&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;72&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  private&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;73&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;74&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Use callbacks to share common setup or constraints between actions.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;75&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Never trust parameters from the scary internet, only allow the white list through.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;76&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def plan_params&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;3&quot; data-linenumber=&quot;77&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;3&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    params.require(:plan).permit(:stripe_id, :name, :amount, :interval)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;78&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;79&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="7634ce5face526954200be5a5274eae6da322d07">
  <div class="header">
    <h3>app/controllers/registrations_controller.rb</h3>
    <h4><span class="red">10.67 %</span> covered</h4>
    <div>
      <b>75</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>67</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Handles **Devise/Stripe Registrations*.It basically adapts the methods of devise when needed mainly for stripe integration.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {LogonTest Corresponding integration tests}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/registrations_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;7&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class RegistrationsController &lt; Devise::RegistrationsController&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # call super devise methods&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;9&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [devise/registrations/new.html.erb] &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;10&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET /users/sign_up(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path new_user_registration &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;12&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    super&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;15&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;16&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # To create a new registration, we check that it is valid for User model and no email duplicated,  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # then we create the stripe records first and if OK we create the user.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # All the errors are rescued with flash message.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [records] if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [error] if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url POST /users(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;22&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path user_registration&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def create&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;24&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    build_resource(sign_up_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # initialize empty fields    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    resource.email = params[:stripeEmail]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    resource.stripe_card_token = params[:stripeToken]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    resource.invoice_count = 1 # need to initialize to 1 because customer.created event can arrive after&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;29&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    resource.valid?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;30&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # check if the user models verifications are good&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;31&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    if !resource.errors.messages.empty? # there is at least an error&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;32&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      user_model_flash_errors&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;33&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      # check that this email has not yet been created in user table&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;34&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    elsif User.exists?(email: params[:stripeEmail])&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;35&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to_back_or_default(alert: t(&#39;email_allready_used&#39;))&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;36&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;37&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      # create Stripe customer first&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;38&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      begin  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        if resource.plan_id.length.zero? &amp;&amp; Rails.env.test?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          resource.plan_id = &#39;month-plan&#39; # force plan if empty mainly for testing purpose&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        end    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        Stripe::Customer.create(&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          email: params[:stripeEmail],         &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          source: params[:stripeToken],&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;45&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          plan: resource.plan_id&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;46&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        )&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;47&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      rescue Stripe::CardError&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;48&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        flash[:notice] = t(&#39;stripe_card_error&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;49&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        redirect_to new_selector_path&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;50&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        return&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;51&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      rescue Stripe::StripeError&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;52&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        flash[:notice] = t(&#39;stripe_error&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;53&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        puts &quot;create error: #{e.message}&quot;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;54&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        redirect_to new_selector_path&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;55&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        return    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;56&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;57&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;58&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      # create Devise user&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;59&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      resource.language = I18n.locale.to_s&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;60&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      resource.save&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;61&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      yield resource if block_given?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;62&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      if resource.persisted?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;63&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        if resource.active_for_authentication?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;64&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          set_flash_message! :notice, :signed_up&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;65&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          system &#39;sms_create_user.sh&#39; if Rails.env.production?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;66&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          sign_up(resource_name, resource)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;67&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          respond_with resource, location: after_sign_up_path_for(resource)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;68&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;69&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          set_flash_message! :notice, :&quot;signed_up_but_#{resource.inactive_message}&quot;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;70&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          expire_data_after_sign_in!&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;71&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          respond_with resource, location: after_inactive_sign_up_path_for(resource)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;72&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;73&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;74&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        clean_up_passwords resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;75&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        set_minimum_password_length&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;76&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        respond_with resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;77&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;78&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;79&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;80&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;81&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Code copied from devise and modified to get flash error messages &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;82&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # All the errors are rescued with flash message.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;83&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [home_screen] if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;84&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [error] if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;85&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url PATCH  /users(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;86&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def update&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;87&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    self.resource = resource_class.to_adapter.get!(send(:&quot;current_#{resource_name}&quot;).to_key)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;88&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    prev_unconfirmed_email = resource.unconfirmed_email if resource.respond_to?(:unconfirmed_email)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;89&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    resource_updated = update_resource(resource, account_update_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;90&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    yield resource if block_given?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;91&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    if resource_updated&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;92&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      if is_flashing_format?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;93&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        flash_key = &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;94&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          update_needs_confirmation?(resource, prev_unconfirmed_email) ? :update_needs_confirmation : :updated&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;95&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        set_flash_message :notice, flash_key&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;96&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;97&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      sign_in resource_name, resource, bypass: true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;98&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      respond_with resource, location: after_update_path_for(resource)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;99&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    elsif !resource.errors.messages.empty? # there is at least an error&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;100&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      user_model_flash_errors&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;101&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;102&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      clean_up_passwords resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;103&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      respond_with resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;104&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;105&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;106&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;107&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # To delete a  registration, we delete the stripe records first and then the user.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;108&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # All the errors are rescued with flash message.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;109&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [home_screen] if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;110&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [error] if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;111&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url DELETE /users(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;112&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;113&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # first delete Stripe customer&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;114&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    begin&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;115&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      cu = Stripe::Customer.retrieve(resource.customer_id)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;116&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      cu.delete&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;117&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    rescue Stripe::StripeError&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;118&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      flash[:notice] = t(&#39;stripe_error&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;119&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to edit_user_registration_path&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;120&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      return&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;121&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;122&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # then delete user with Devise&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;123&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    super&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;124&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    system &#39;sms_delete_user.sh&#39; if Rails.env.production?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;125&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;126&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;127&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # redirect to previous page and if not present to home&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;128&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [url] if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;129&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def redirect_to_back_or_default(*args)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;130&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    if request.env[&#39;HTTP_REFERER&#39;].present? &amp;&amp; request.env[&#39;HTTP_REFERER&#39;] != request.env[&#39;REQUEST_URI&#39;]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;131&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to :back, *args&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;132&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;133&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to root_url, *args&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;134&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;135&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;136&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;137&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Prepare the error flash message&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;138&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [url] with a flash message&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;139&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def user_model_flash_errors&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;140&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    case resource.errors.keys.first&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;141&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    when :password_confirmation&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;142&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to_back_or_default(alert: t(&#39;password_confirmation_error&#39;))&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;143&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    when :email&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;144&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to_back_or_default(alert: t(&#39;email_allready_used&#39;))&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;145&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    when :password&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;146&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to_back_or_default(alert: t(&#39;password_error&#39;))&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;147&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    when :name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;148&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to_back_or_default(alert: t(&#39;name_blanck_error&#39;))&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;149&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    when :current_password&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;150&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to_back_or_default(alert: t(&#39;password_error&#39;))    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;151&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;152&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to_back_or_default(alert: t(&#39;user_parameter_error&#39;))&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;153&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end     &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;154&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;155&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="d9378aacd2661f399cb0d794c399a9e908c90d70">
  <div class="header">
    <h3>app/controllers/roles_controller.rb</h3>
    <h4><span class="green">95.45 %</span> covered</h4>
    <div>
      <b>22</b> relevant lines. 
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Handles the {Role **Role model**} used by devise and cancancan gems.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Only accessible to users with *admin* role.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# The routes of this controller support localization but the web pages are not translated as it is used only by admin.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {RolesControllerTest Corresponding tests:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/roles_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class RolesController &lt; ApplicationController&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  load_and_authorize_resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Asks for new role&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;13&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/roles/new(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path new_role&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def new    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;16&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays roles list with bootstrap table sortable format&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/roles(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path roles&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;22&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def index&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;3&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;3&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @roles = Role.all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;24&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the role and the users associated with it.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [show.html.erb] the show web page. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/roles/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;29&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path role  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;30&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def show&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;31&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @associated_users = @role.users.empty? ? &#39;None&#39; : @role.users.map(&amp;:name).join(&#39;, &#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;32&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;33&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;34&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the role to be modified&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;35&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [edit.html.erb] the edit web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;36&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/roles/:id/edit(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;37&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path edit_role  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;38&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def edit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Save the new role in the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url POST(/:locale)/roles(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;45&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def create&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;46&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @role.save&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;47&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to @role, notice: &#39;Role was successfully created.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;48&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;49&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      render :new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;50&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;51&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;52&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;53&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Update the role in the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;54&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;55&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [edit.html.erb] the edit web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;56&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url PUT (/:locale)/roles/:id(.:format)  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;57&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def update&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;58&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @role.update(role_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;59&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to @role, notice: &#39;Role was successfully updated.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;60&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;61&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      render :edit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;62&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;63&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;64&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;65&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Delete the role from the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;66&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;67&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url DELETE(/:locale)/roles/:id(.:format)  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;68&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;69&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @role.destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;70&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    redirect_to roles_url, notice: &#39;Role was successfully destroyed.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;71&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;72&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;73&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  private&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;74&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;75&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Use callbacks to share common setup or constraints between actions.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;76&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Never trust parameters from the scary internet, only allow the white list through.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;77&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def role_params&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;3&quot; data-linenumber=&quot;78&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;3&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    params.require(:role).permit(:name, :description)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;79&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;80&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="719a452ca7de5e2350f2a356737387172a98c1a5">
  <div class="header">
    <h3>app/controllers/selectors_controller.rb</h3>
    <h4><span class="green">92.52 %</span> covered</h4>
    <div>
      <b>147</b> relevant lines. 
      <span class="green"><b>136</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# In charge of statistics data retrieval, analysis and rendering.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Data are retrieved from the WorldBank database.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Statistics are computed by R library through Rserve. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Data are send for rendering with gon gem for javascript.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Chart is rendered with Rgraph.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;9&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# This controller support full localization (routes, fields and data).  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;10&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {SelectorCustomerTest Corresponding integration tests for users:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {SelectorAnonymousTest Corresponding integration tests for anonymous:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#  ![Class Diagram](diagram/selectors_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class SelectorsController &lt; ApplicationController&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;14&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  require &#39;rserve/simpler&#39; # R API&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  require &#39;action_view&#39; # for number_to_human&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;16&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  include ActionView::Helpers::NumberHelper&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;17&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  autocomplete :indicator, :id1, full:  true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;18&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  autocomplete :country, :name,  full:  true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # We override the standard method to implement filtering.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # indicator and country input field are autocompleted and filtered by ability and language&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param parameters [Hash]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;22&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [Hash] filtered list  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def get_autocomplete_items(parameters)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;205&quot; data-linenumber=&quot;24&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;205&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    items = active_record_get_autocomplete_items(parameters)        &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;205&quot; data-linenumber=&quot;25&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;205&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    items = items.accessible_by(current_ability).where(language: I18n.locale) if&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;205&quot; data-linenumber=&quot;26&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;205&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      parameters[:model] == Indicator || parameters[:model] == Country&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;29&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Asks for indicators and countries for statistics&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;30&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.(en,fr).html.erb] the new web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;31&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/selectors/new(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;32&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path selectorsnew&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;33&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;224&quot; data-linenumber=&quot;34&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;224&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @indicator_base = Indicator.accessible_by(current_ability).where(language: I18n.locale).order(:topic, :id1).all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;224&quot; data-linenumber=&quot;35&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;224&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @country_base = Country.accessible_by(current_ability).where(language: I18n.locale).order(:type, :name).all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;224&quot; data-linenumber=&quot;36&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;224&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @selector = Selector.new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;224&quot; data-linenumber=&quot;37&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;224&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @language = I18n.locale.to_s&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;38&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Fetch data, compute and prepare for rendering. This is not a restful create.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # The user can loop on create to change its statistics.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [create.html.erb] the create web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url POST (/:locale)/selectors(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;44&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def create&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;45&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    begin # find indicators and countries from table&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;46&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @indicator_base = Indicator.accessible_by(current_ability).where(language: I18n.locale).order(:topic, :id1).all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;47&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @country_base = Country.accessible_by(current_ability).where(language: I18n.locale).order(:type, :name).all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;48&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @selector = Selector.new(selector_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;49&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @indicator = params[:fake_indicator]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;50&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @percent = @indicator[@indicator.length - 3, @indicator.length] == &#39;.ZS&#39; ? true : false  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;51&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @i1 = Indicator.accessible_by(current_ability).where(id1: @indicator, language: I18n.locale).take&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;52&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @c1 = Country.accessible_by(current_ability).where(name: params[:fake_country1], language: I18n.locale).take&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;53&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      # check if we compare countries or indicators&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;54&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @indicator_switch = params[:selector][:form_switch] == &#39;indicator&#39; ? true : false&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;55&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      if @indicator_switch&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;12&quot; data-linenumber=&quot;56&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;12&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @indicator2 = params[:fake_indicator2]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;12&quot; data-linenumber=&quot;57&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;12&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @percent2 = @indicator2[@indicator2.length - 3, @indicator2.length] == &#39;.ZS&#39; ? true : false&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;12&quot; data-linenumber=&quot;58&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;12&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @i2 = Indicator.accessible_by(current_ability).where(id1: @indicator2, language: I18n.locale).take&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;59&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;48&quot; data-linenumber=&quot;60&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;48&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @c2 = Country.accessible_by(current_ability).where(name: params[:fake_country2], language: I18n.locale).take&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;48&quot; data-linenumber=&quot;61&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;48&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @percent2 = @percent&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;62&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;63&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @indicator = &#39;&#39; unless @i1.present? # need to check if the indicator is not hacked&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;64&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @indicator2 = &#39;&#39; unless @i2.present? # need to check if the indicator is not hacked&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;65&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      if @c1.present? # need to check if the country is not hacked&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;52&quot; data-linenumber=&quot;66&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;52&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @country1 = @c1.iso2code&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;52&quot; data-linenumber=&quot;67&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;52&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @country1_name = @c1.name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;68&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;69&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      if @c2.present? # need to check if the country is not hacked&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;40&quot; data-linenumber=&quot;70&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;40&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @country2 = @c2.iso2code&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;40&quot; data-linenumber=&quot;71&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;40&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        @country2_name = @c2.name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;72&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;73&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    rescue ActiveRecord::RecordNotFound&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;74&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      flash[:notice] = t(&#39;wrong_parameter&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;75&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to new_selector_path(locale: I18n.locale)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;76&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      return&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;77&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;78&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;79&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    begin # get worldbank data&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;80&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @period = params[:selector][:year_begin].to_s + &#39;:&#39; + params[:selector][:year_end].to_s # format period for WorldBank    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;81&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @results1 = WorldBank::Data.country(@country1).indicator(@indicator).dates(@period).fetch # bug .language(&#39;fr&#39;) &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;44&quot; data-linenumber=&quot;82&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;44&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @results2 = @indicator_switch ? WorldBank::Data.country(@country1).indicator(@indicator2).dates(@period).fetch&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;83&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                                    : WorldBank::Data.country(@country2).indicator(@indicator).dates(@period).fetch       &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;84&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    rescue StandardError&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;32&quot; data-linenumber=&quot;85&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;32&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      flash[:notice] = t(&#39;wrong_worldbank_fetch&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;32&quot; data-linenumber=&quot;86&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;32&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to new_selector_path&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;32&quot; data-linenumber=&quot;87&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;32&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      return&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;88&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;89&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;90&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    v1 = []&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;91&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    v2 = []&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;92&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    y = []&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;93&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    y_to_i = []        &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;94&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    (0..(@results1.size - 1)).each do |d| # percentage handling f for percentage else integer          &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;300&quot; data-linenumber=&quot;95&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;300&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      v1[d] = @results1[(@results1.size - 1) - d].value.to_f if @percent &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;300&quot; data-linenumber=&quot;96&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;300&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      v2[d] = @results2[(@results1.size - 1) - d].value.to_f if @percent2 || (!@indicator_switch &amp;&amp; @percent)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;300&quot; data-linenumber=&quot;97&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;300&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      v1[d] = @results1[(@results1.size - 1) - d].value.to_i unless @percent&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;300&quot; data-linenumber=&quot;98&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;300&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      v2[d] = @results2[(@results1.size - 1) - d].value.to_i if !@percent2 || (!@indicator_switch &amp;&amp; !@percent)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;300&quot; data-linenumber=&quot;99&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;300&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      y[d] = @results1[(@results1.size - 1) - d].date&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;300&quot; data-linenumber=&quot;100&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;300&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      y_to_i[d] = y[d].to_i # R needs integers for correct calculus&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;101&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;102&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;103&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    l  = [v1.max.to_s.length, v1.max.to_s.length].max # l contains the length of the biggest integer&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;104&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    l2 = [v2.max.to_s.length, v2.max.to_s.length].max&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;105&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;106&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @scale = get_scale(l, @percent) # compute the dividing scale for first serie                           &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;107&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @unit = get_unit(l) # compute the unit &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;108&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @indicator_switch &amp;&amp; l != l2&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;109&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @scale2 = get_scale(l2, @percent2)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;110&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @unit2 = get_unit(l2)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;111&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @same_scale = false&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;112&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @scale_change = @scale.to_s.length - @scale2.to_s.length&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;113&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;24&quot; data-linenumber=&quot;114&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;24&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @same_scale = true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;24&quot; data-linenumber=&quot;115&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;24&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @scale_change = 0&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;24&quot; data-linenumber=&quot;116&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;24&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @power_scale_change = 1&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;117&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;118&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;328&quot; data-linenumber=&quot;119&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;328&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    v1.collect! { |i| i / @scale } # apply the scale&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;120&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @same_scale&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;292&quot; data-linenumber=&quot;121&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;292&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      v2.collect! { |i| i / @scale }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;24&quot; data-linenumber=&quot;122&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;24&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @ylabels = true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;123&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;36&quot; data-linenumber=&quot;124&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;36&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      v2.collect! { |i| i / @scale2 }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;125&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @ylabels = false&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;126&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;127&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # v = [v1, v2]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;128&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # rescale v2 to display correct graph value&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;129&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    l1b = @percent ? 2 : [v1.max.to_s.length, v1.max.to_s.length].max # l contains the length of the biggest integer or 2 for percentage&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;130&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    l2b = @percent2 ? 2 : [v2.max.to_s.length, v2.max.to_s.length].max&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;131&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @power_scale_change = @indicator_switch ? (10**(l1b - l2b)).to_f : 1&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;132&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # l1b = [v1.max.to_s.length, v1.max.to_s.length].max # l contains the length of the biggest integer&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;133&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # l2b = [v2.max.to_s.length, v2.max.to_s.length].max&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;328&quot; data-linenumber=&quot;134&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;328&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    v2_rescaled = v2.collect { |i| (i * @power_scale_change).to_i }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;135&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    v = [v1, v2_rescaled]                                           &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;136&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @precision = @percent ? 2 : 0&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;137&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if I18n.locale == :en # set number format for Rgraph&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;14&quot; data-linenumber=&quot;138&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;14&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @scale_thousand = &#39;,&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;14&quot; data-linenumber=&quot;139&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;14&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @scale_point = &#39;.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;14&quot; data-linenumber=&quot;140&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;14&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @language = &#39;en&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;141&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;14&quot; data-linenumber=&quot;142&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;14&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @scale_thousand = &#39; &#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;14&quot; data-linenumber=&quot;143&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;14&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @scale_point = &#39;,&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;14&quot; data-linenumber=&quot;144&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;14&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @language = &#39;fr&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;145&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;146&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # X axis positioning&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;147&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @xaxispos = &#39;bottom&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;148&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @xaxispos = &#39;center&#39; if v1.min &lt; 0 || v2.min &lt; 0&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;149&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;150&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @indicator_switch &amp;&amp; @xaxispos == &#39;center&#39; # set min value&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;151&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @min1 = v1.min &lt; 0 ? v1.min : 0&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;152&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @min2 = v2.min &lt; 0 ? v2.min : 0 &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;153&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;26&quot; data-linenumber=&quot;154&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;26&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @min1 = 0&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;26&quot; data-linenumber=&quot;155&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;26&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @min2 = 0&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;156&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;157&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;158&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # title scaffolding &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;159&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @title_scale_unit = &#39; &#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;160&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @same_scale # only show scale on title if same scale&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;24&quot; data-linenumber=&quot;161&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;24&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @title_scale_unit = @percent ? &#39; - &#39; &lt;&lt; t(&#39;with_percent&#39;) :&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;162&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                   &#39; - &#39; &lt;&lt; t(&#39;with_scale&#39;) &lt;&lt; &#39;: 1/&#39; &lt;&lt; number_with_delimiter(@scale, locale: I18n.locale) \&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;163&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                   &lt;&lt; &#39; - &#39; &lt;&lt; t(&#39;with_unit&#39;) &lt;&lt; &#39;: &#39; &lt;&lt; @unit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;164&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else                     &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;165&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @title_first_axis = @percent ? t(&#39;with_percent&#39;) :&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;166&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                   t(&#39;with_scale&#39;) &lt;&lt; &#39;: 1/&#39; &lt;&lt; number_with_delimiter(@scale, locale: I18n.locale)\&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;167&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                   &lt;&lt; &#39; - &#39; &lt;&lt; t(&#39;with_unit&#39;) &lt;&lt; &#39;: &#39; &lt;&lt; @unit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;168&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @title_second_axis = @percent2 ? t(&#39;with_percent&#39;) :&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;169&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                    t(&#39;with_scale&#39;) &lt;&lt; &#39;: 1/&#39; &lt;&lt; number_with_delimiter(@scale2, locale: I18n.locale)\&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;170&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                    &lt;&lt; &#39; - &#39; &lt;&lt; t(&#39;with_unit&#39;) &lt;&lt; &#39;: &#39; &lt;&lt; @unit2     &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;171&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;172&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @indicator_switch&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;173&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      gon.indicator2 = @i2.name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;174&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      gon.country2 = &#39;&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;175&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @title = t(&#39;compare&#39;) &lt;&lt; &#39;: &#39; &lt;&lt; @i1.name &lt;&lt; &#39; / &#39; &lt;&lt; @i2.name \&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;176&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;           &lt;&lt; &#39; - &#39; &lt;&lt; t(&#39;country&#39;) &lt;&lt; &#39;: &#39; &lt;&lt; @c1.name  \&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;177&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;           &lt;&lt; @title_scale_unit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;178&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;24&quot; data-linenumber=&quot;179&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;24&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      gon.indicator2 = &#39;&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;24&quot; data-linenumber=&quot;180&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;24&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      gon.country2 = @c2.name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;24&quot; data-linenumber=&quot;181&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;24&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @title = t(&#39;compare&#39;) &lt;&lt; &#39;: &#39; &lt;&lt; @c1.name &lt;&lt; &#39; / &#39; &lt;&lt; @c2.name \&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;182&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;           &lt;&lt; &#39; - &#39; &lt;&lt; t(&#39;indicator&#39;) &lt;&lt; &#39;: &#39; &lt;&lt; @i1.name \&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;183&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;           &lt;&lt; @title_scale_unit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;184&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;185&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @current_user_email = user_signed_in? ? current_user.email : &#39;no_user&#39; # set email for google analytics  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;186&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # send data in js format        &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;187&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    gon.push(                                       &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;188&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      title: @title, language: @language,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;189&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      data: v, data1: v1, data2: v2,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;190&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      year: y, numxticks: y.length - 1,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;191&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      indicator: @i1.name, country1: @c1.name,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;192&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      scale: @scale, xaxispos: @xaxispos, ylabels: @ylabels,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;193&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      power_scale_change: @power_scale_change,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;194&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      scale_thousand: @scale_thousand, scale_point: @scale_point,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;195&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      title_first_axis: @title_first_axis, title_second_axis: @title_second_axis,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;196&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      min1: @min1, min2: @min2&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;197&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    )&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;198&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;199&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # __________Statistics______________&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;200&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    begin&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;201&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      c = Rserve::Connection.new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;202&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      c.assign(&#39;year&#39;, y_to_i)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;203&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      c.assign(&#39;vect1&#39;, v1)        &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;204&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      c.assign(&#39;vect2&#39;, v2)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;205&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @mean1 = c.eval(&#39;mean(vect1)&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;206&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @mean2 = c.eval(&#39;mean(vect2)&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;207&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @cor = c.eval(&#39;cor(vect1,vect2)&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;208&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @coeflm1 = c.eval(&#39;coefficients(lm(vect1 ~ year))&#39;).as_floats&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;209&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @coeflm2 = c.eval(&#39;coefficients(lm(vect2 ~ year))&#39;).as_floats&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;210&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @coeflm3_1 = c.eval(&#39;summary(lm(vect1 ~ year))$r.squared &#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;211&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @coeflm3_2 = c.eval(&#39;summary(lm(vect2 ~ year))$r.squared &#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;212&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @meanrate1 = (@coeflm1[1] / @mean1.to_ruby) * 100&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;28&quot; data-linenumber=&quot;213&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;28&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @meanrate2 = (@coeflm2[1] / @mean2.to_ruby) * 100&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;214&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    rescue StandardError&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;215&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      flash[:notice] = t(&#39;rserve_problem&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;216&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to new_selector_path&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;217&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      return&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;218&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;219&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;220&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;221&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # compute scale for the graph&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;222&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [Integer] scale&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;223&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param l [Integer] length of the largest absolute numeric values&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;224&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param percent [Boolean] check if it is a percentage&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;225&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def get_scale(l, percent)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;32&quot; data-linenumber=&quot;226&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;32&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    scale = case l                                 &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;6&quot; data-linenumber=&quot;227&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;6&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;            when 1..6 then 1&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;228&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;            when 7..9 then 1000&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;229&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;            when 10..12 then 1_000_000&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;26&quot; data-linenumber=&quot;230&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;26&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;            else 1_000_000_000  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;231&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;            end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;32&quot; data-linenumber=&quot;232&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;32&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    scale = 1 if percent # rectify scale for percentage&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;32&quot; data-linenumber=&quot;233&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;32&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    return scale&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;234&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;235&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;236&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Translate to unit in english and french&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;237&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [String] unit (ex: thousand, million)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;238&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param l [Integer] length of the largest absolute numeric values&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;239&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def get_unit(l)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;32&quot; data-linenumber=&quot;240&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;32&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    case l                                 &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;6&quot; data-linenumber=&quot;241&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;6&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    when 1..6 then &#39;unit&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;242&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    when 7..9 then t(&#39;thousand&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;243&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    when 10..12 then t(&#39;million&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;26&quot; data-linenumber=&quot;244&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;26&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    else t(&#39;billion&#39;)  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;245&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;246&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;247&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;248&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  private&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;249&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;250&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Use callbacks to share common setup or constraints between actions.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;251&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Never trust parameters from the scary internet, only allow the white list through.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;252&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def selector_params&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;60&quot; data-linenumber=&quot;253&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;60&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    params.require(:selector).permit(:form_switch, :indicator, :indicator2, :country1, :country2, :year_begin, :year_end)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;254&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;255&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="d3c729b708c3670089183604fbe4b55ebc5a1c76">
  <div class="header">
    <h3>app/controllers/users_controller.rb</h3>
    <h4><span class="yellow">88.46 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Handles the {User **User model**} which is central for user management due to links with devise and stripe.     &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Only visible by users with *admin* role.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# This controller support localization for routes.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {UsersControllerTest Corresponding tests:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/users_controller_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class UsersController &lt; ApplicationController&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  load_and_authorize_resource&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Asks for new user. Normally, users are not created this way.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;13&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/admin/users/new(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path new_user&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;16&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays users list with bootstrap table sortable format. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/admin/users(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path users&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;22&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def index&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;3&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;3&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @users = User.all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;24&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the user &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [show.html.erb] the show web page. &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/admin/users/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;29&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path user&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;30&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def show # format correctly the join date and the last_login date&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;31&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @joined_on = @user.created_at.to_formatted_s(:short)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;32&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @last_login = @user.current_sign_in_at ? @user.current_sign_in_at.to_formatted_s(:short) : &#39;never&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;33&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;34&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;35&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Displays the user to be modified&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;36&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [edit.html.erb] the edit web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;37&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url GET(/:locale)/admin/users/:id/edit(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;38&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @path edit_user&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;39&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def edit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Save the new user in the database. Rescue error message with flash.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new.html.erb] the new web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;45&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url POST(/:locale)/admin/users(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;46&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def create      &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;47&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    respond_to do |format|&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;48&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      if @user.save&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;49&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        format.html { redirect_to @user, notice: &#39;User was successfully created.&#39; }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;50&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;51&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        format.html { render :new }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;52&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;53&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;54&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  rescue Stripe::CardError =&gt; e&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;55&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    flash[:error] = e.message&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;56&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    redirect_to new_user_path&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;57&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;58&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;59&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Update the user in the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;60&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page if successfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;61&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [edit.html.erb] the edit web page if unsuccessfull&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;62&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url PUT (/:locale)/admin/users/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;63&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def update&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;64&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if @user.update(user_params)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;65&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      redirect_to @user, notice: &#39;User was successfully updated.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;66&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;67&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      render :edit&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;68&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;69&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;70&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;71&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Delete the user from the database&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;72&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [index.html.erb] the index web page&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;73&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @rest_url DELETE(/:locale)/admin/users/:id(.:format)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;74&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;75&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @user.destroy&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;76&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    redirect_to users_url, notice: &#39;User was successfully destroyed.&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;77&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;78&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;79&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  private&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;80&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;81&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Use callbacks to share common setup or constraints between actions.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;82&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Never trust parameters from the scary internet, only allow the white list through.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;83&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def user_params&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;3&quot; data-linenumber=&quot;84&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;3&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    params.require(:user).permit(:name, :email, :role_id, :plan_id, :password, :password_confirmation)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;85&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;86&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="b68eac321c0b040bd21e477511d0f3b7b0c8a05f">
  <div class="header">
    <h3>app/helpers/application_helper.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# empty&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;2&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;module ApplicationHelper&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="f9c937155ee5a5c2aead667d89d3af63fcc352c4">
  <div class="header">
    <h3>app/helpers/selectors_helper.rb</h3>
    <h4><span class="yellow">83.33 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;4&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;module SelectorsHelper&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Returns the full title on a per-page basis.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param page_title [String]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [String] Title  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;8&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def full_title(page_title = &#39;&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;360&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;360&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    base_title = &#39;ESoOD&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;360&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;360&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if page_title.empty?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;360&quot; data-linenumber=&quot;11&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;360&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      base_title&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;13&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      page_title + &#39; | &#39; + base_title&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;15&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;16&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="3b31ac6d7aa4680df717e38794549ff067ad7f1e">
  <div class="header">
    <h3>app/helpers/stripe_helper.rb</h3>
    <h4><span class="green">98.21 %</span> covered</h4>
    <div>
      <b>56</b> relevant lines. 
      <span class="green"><b>55</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;1&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;require &#39;invoicing/ledger_item/pdf_generator&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# copy of module StripeHelper and modification of the report for prawn gem&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;6&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;module StripeHelper&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Modification of PdfGenerator for customization of the invoice&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;8&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  class MyInvoiceGenerator &lt; Invoicing::LedgerItem::PdfGenerator&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;9&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # initialize method&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;10&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @return [InvoicingLedgerItem] @invoice&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @param invoice [InvoicingLedgerItem]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;12&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    def initialize(invoice)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      @invoice = invoice&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;15&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;16&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # attribute reader invoice&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;17&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    attr_reader :invoice&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # render method&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @return [file] invoice in pdf format&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @param file [File]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;21&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    def render(file)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;22&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      Prawn::Document.generate(file) do |pdf|&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        render_headers(pdf)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;24&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        render_details(pdf)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;25&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        render_summary(pdf)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;29&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    private&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;30&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;31&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # render_header method&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;32&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @return [Hash] invoice header&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;33&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @param pdf [Hash]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;34&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    def render_headers(pdf)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;35&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.table([[I18n.t(&#39;invoice_title&#39;)]], width: 540, cell_style: { padding: 0 }) do&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;36&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        row(0..10).borders = []&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;37&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        cells.column(0).style(size: 20, font_style: :bold, valign: :center)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;38&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # Renders details  pdf. Shows company name, invoice date and id&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @return [Hash] invoice details&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @param pdf [Hash]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;44&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    def render_details(pdf)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;45&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.move_down 10&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;46&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.stroke_horizontal_rule&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;47&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.move_down 15&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;48&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;49&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      company_name = User.find(invoice.sender_id).company_name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;50&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      billing_details =&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;51&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        pdf.make_table(&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;52&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          [[I18n.t(&#39;billed_to&#39;), company_name]],&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;53&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;          column_widths: [55, 300], cell_style: { padding: 0 }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;54&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        ) do&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;55&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;          row(0..10).style(size: 9, borders: [])&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;56&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;          row(0).column(1).style(font_style: :bold)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;57&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;          cells.columns(0..1).align = :left&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;58&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;59&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      invoice_date = I18n.l(invoice.created_at, format: :default)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;60&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      invoice_id   = invoice.id.to_s&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;61&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      invoice_details =&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;62&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        pdf.make_table([[I18n.t(&#39;invoice_date&#39;), invoice_date], [I18n.t(&#39;invoice_no&#39;), invoice_id]],&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;63&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                       width: 185, position: :right, cell_style: { padding: 5, border_width: 0.5 }) do&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;64&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;          row(0..10).style(size: 9)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;65&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;          row(0..10).column(0).style(font_style: :bold)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;66&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;67&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;68&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.table([[billing_details, invoice_details]], cell_style: { padding: 0 }) do&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;69&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        row(0..10).style(borders: [])&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;70&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;71&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;72&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;73&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # Renders details of invoice in a tabular format. Renders each line item, and&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;74&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # unit price, and total amount, along with tax. It also displays summary,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;75&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # ie total amount, and total price along with tax.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;76&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @return [Hash] invoice details&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;77&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @param pdf [Hash]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;78&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    def render_summary(pdf)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;79&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.move_down 25&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;80&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.text I18n.t(&#39;invoice_summary&#39;), size: 12, style: :bold&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;81&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.stroke_horizontal_rule&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;82&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;83&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      table_details = [[I18n.t(&#39;item_no&#39;), I18n.t(&#39;description&#39;), I18n.t(&#39;unit_price&#39;), I18n.t(&#39;total_price&#39;)]]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;84&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      invoice.line_items.each_with_index do |line_item, index|&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;85&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        net_amount = line_item.net_amount_formatted&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;86&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        table_details &lt;&lt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;87&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;          [index + 1, line_item.description, net_amount, net_amount]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;88&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;89&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.table(table_details,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;90&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                column_widths: [40, 380, 60, 60],&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;91&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                header: true,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;92&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;                cell_style: { padding: 5, border_width: 0.5 }) do&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;93&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        row(0).style(size: 10, font_style: :bold)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;94&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        row(0..100).style(size: 9)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;95&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        cells.columns(0).align = :right&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;96&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        cells.columns(2).align = :right&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;97&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        cells.columns(3).align = :right&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;98&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        row(0..100).borders = [:top, :bottom]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;99&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;100&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;101&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      summary_details = [&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;102&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        [I18n.t(&#39;subtotal&#39;), invoice.net_amount_formatted],&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;103&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        [I18n.t(&#39;tax&#39;), invoice.tax_amount_formatted],&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;104&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;        [I18n.t(&#39;total&#39;), invoice.total_amount_formatted]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;105&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      ]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;106&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.table(summary_details,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;107&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                column_widths: [480, 60],&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;108&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;                header: true,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;109&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;                cell_style: { padding: 5, border_width: 0.5 }) do&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;110&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        row(0..100).style(size: 9, font_style: :bold)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;111&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        row(0..100).borders = []&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;112&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;        cells.columns(0..100).align = :right&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;113&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;114&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;115&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.move_down 25&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;116&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      pdf.stroke_horizontal_rule&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;117&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;118&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;119&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # determine the recipient name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;120&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # @return [String] invoice details&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;121&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    def recipient_name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;missed&quot; data-hits=&quot;0&quot; data-linenumber=&quot;122&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;      invoice.recipient.respond_to?(:name) ? invoice.recipient.name : &#39;&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;123&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;124&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;125&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="b456b8f40eaa9327fbd038a8c89470b2a435e06d">
  <div class="header">
    <h3>app/mailers/my_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Default values for devise mailer  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {MyMailerTest Corresponding tests:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {MyMailerPreview Corresponding mails preview:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/my_mailer_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;8&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class MyMailer &lt; Devise::Mailer   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  helper :application # gives access to all helpers defined within `application_helper`.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  include Devise::Controllers::UrlHelpers # Optional. eg. `confirmation_url`&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;11&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  default template_path: &#39;devise/mailer&#39; # to make sure that your mailer uses the devise views&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Overrides from to for Devise::Mailer&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def confirmation_instructions(record, token, opts = {})&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;110&quot; data-linenumber=&quot;14&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;110&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    headers[&#39;Custom-header&#39;] = &#39;Bar&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;110&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;110&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    opts[:from] = &#39;bgardin@gmail.com&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;110&quot; data-linenumber=&quot;16&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;110&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    opts[:reply_to] = &#39;bgardin@gmail.com&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;110&quot; data-linenumber=&quot;17&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;110&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    super   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Overrides same inside Devise::Mailer&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;21&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def reset_password_instructions(record, token, opts = {})&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;22&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    super&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;23&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;24&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Overrides same inside Devise::Mailer&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;26&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def unlock_instructions(record, token, opts = {})&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;4&quot; data-linenumber=&quot;27&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;4&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    super&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;29&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="a854e8c6b899da7d81d58afabf9b962364614950">
  <div class="header">
    <h3>app/mailers/user_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Define values for mails to admin  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {UserMailerTest Corresponding tests:}   &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# ![Class Diagram](diagram/my_mailer_diagram.png)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;7&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class UserMailer &lt; ActionMailer::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;8&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  default from: &#39;bgardin@gmail.com&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  layout &#39;mailer&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;10&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Construct mail for new registration&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [new_customer_email.html.erb]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param user [Record]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def new_customer_email(user)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;14&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @user = user  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    mail(to: &#39;bgardin@gmail.com&#39;, subject: &#39;New customer on ESoOD&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;16&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;18&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Construct mail for payment_problem&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [payment_problem_email.html.erb]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param user [Record]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;21&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def payment_problem_email(user)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;22&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @user = user &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    mail(to: &#39;bgardin@gmail.com&#39;, subject: &#39;Payment problem on ESoOD&#39;)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;24&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Construct mail for registration suppression&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [destroy_customer_email.html.erb]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;28&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param email [String]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;29&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def destroy_customer_email(email)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;30&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    @email = email  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;31&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    mail(to: &#39;bgardin@gmail.com&#39;, subject: &#39;Customer deleted on ESoOD&#39;) do |format|&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2&quot; data-linenumber=&quot;32&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      format.html { render locals: { email: @email } }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;33&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;34&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;35&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;36&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Construct mail for invoice mail to end user&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;37&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [invoice_email.html.erb]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;38&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param email (String)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param invoice_pdf (Filename)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;40&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def invoice_email(email, invoice_pdf)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;41&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    attachments.inline[&#39;invoice.pdf&#39;] = File.read(invoice_pdf)  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;42&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    mail(to: email, subject: t(&#39;ESoOD_Invoice&#39;))&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="262043dcc7cd869b211ca1cdc878101fae1ae3cc">
  <div class="header">
    <h3>app/models/ability.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# **Ability model** used by cancan gem.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;5&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class Ability&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;6&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  include CanCan::Ability&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Define abilities for the passed in user here&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @param user [Record]&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def initialize(user)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;10&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # Define abilities for the passed in user here. For example:&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    #&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    #   user ||= User.new # guest user (not logged in)&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    guest = User.new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;14&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    guest.role = Role.new&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    guest.role.name = &#39;Regular&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;16&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    user ||= guest # Guest user&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;17&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    if user.admin?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;48&quot; data-linenumber=&quot;18&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;48&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      can :manage, :all&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;19&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    elsif user.customer?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;218&quot; data-linenumber=&quot;20&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;218&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      can :read, Country&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;218&quot; data-linenumber=&quot;21&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;218&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      can :read, Indicator&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;22&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    else&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;376&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;376&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      can :read, Country, visible: &#39;Y&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;376&quot; data-linenumber=&quot;24&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;376&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;      can :read, Indicator, visible: &#39;Y&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;26&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    can :print_chart, Selector if user.admin? || user.customer?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;27&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    can :full_list, Selector if user.admin? || user.customer?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;28&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    can :show_registration, Selector unless user.customer?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;642&quot; data-linenumber=&quot;29&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;642&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    can :show_admin, :all if user.admin?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;30&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    #&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;31&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # The first argument to `can` is the action you are giving the user&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;32&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # permission to do.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;33&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # If you pass :manage it will apply to every action. Other common actions&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;34&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # here are :read, :create, :update and :destroy.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;35&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    #&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;36&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # The second argument is the resource the user can perform the action on.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;37&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # If you pass :all it will apply to every resource. Otherwise pass a Ruby&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;38&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # class of the resource.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;39&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    #&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;40&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # The third argument is an optional hash of conditions to further filter the&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;41&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # objects.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;42&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # For example, here the user can only update published articles.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;43&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    #&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;44&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    #   can :update, Article, :published =&gt; true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;45&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    #&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;46&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # See the wiki for details:&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;47&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;    # https://github.com/CanCanCommunity/cancancan/wiki/Defining-Abilities&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;48&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;49&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="aba016f201dd543f8c05c9dfb24fe93ed5839b2a">
  <div class="header">
    <h3>app/models/country.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# **Country model** used with WorldBank database.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Country name shoud be unique by language    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Language is in en, fr  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Visible is empty or Y  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {CountryTest Corresponding tests:} &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class Country &lt; ActiveRecord::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  self.inheritance_column = &#39;zoink&#39; # type is a reserved word so need to be renamed&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;11&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :id1, :iso2code, :code, :name, :language, :type, presence: true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;12&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :name, uniqueness: { scope: :language }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :visible, inclusion: { in: [&#39;Y&#39;] }, allow_nil: true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;14&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :language, inclusion: { in: %w(en fr) }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;15&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="bbaa9c778a1095e9ab03dc92f21ac8dccdb82441">
  <div class="header">
    <h3>app/models/indicator.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# **Indicator model** used with WorldBank database.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Indicator 1 shoud be unique by language    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Language is in en, fr  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Visible is empty or Y  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {IndicatorTest Corresponding tests:} &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class Indicator &lt; ActiveRecord::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :id1, :language, :topic, :name, presence: true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;11&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :id1, uniqueness: { scope: :language }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;12&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :visible, inclusion: { in: [&#39;Y&#39;] }, allow_nil: true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :language, inclusion: { in: %w(en fr) }&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;14&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="fd5776f15d1f5ec5a9cc2d52314025a7ce220f53">
  <div class="header">
    <h3>app/models/invoicing_ledger_item.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Defines **InvoicingLedgerItem model** as used by stripe and invoicing gems.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Links with User model for sender and recipient to get email addresses.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Has many potential line items.    &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;7&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class InvoicingLedgerItem &lt; ActiveRecord::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;8&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  acts_as_ledger_item&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  belongs_to :recipient, class_name: &#39;User&#39;, foreign_key: :recipient_id &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  belongs_to :sender, class_name: &#39;User&#39;, foreign_key: :sender_id &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;11&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  has_many :line_items, class_name: &#39;InvoicingLineItem&#39;, foreign_key: :ledger_item_id&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="adb4354c30635c965242a8908985c49c15c9d6ed">
  <div class="header">
    <h3>app/models/plan.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# **Plan model** used for stripe subscription.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Plan stripe_id shoud be unique as it is a key to link to stripe  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Plan amount should be higher than 100 corresponding to 1.00 euro  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;7&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {PlanTest Corresponding tests:} &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;8&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class Plan &lt; ActiveRecord::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :stripe_id, :name, :amount, :interval, presence: true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates_uniqueness_of :stripe_id &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;11&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :amount, numericality: { greater_than: 99 } &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="ced499ce880243f7497455834b540e44e767ca49">
  <div class="header">
    <h3>app/models/role.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# **Role model** used by devise and cancancan gems.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Role name shoud be unique and many users may have the same role  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# {RoleTest Corresponding tests:} &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;7&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class Role &lt; ActiveRecord::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;8&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates :name, :description, presence: true&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates_uniqueness_of :name&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  has_many :users&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="7c21540fe1a6981e554423d8a7f8325720060f7b">
  <div class="header">
    <h3>app/models/selector.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>1</b> relevant lines. 
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# **Selector model** is empty.&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;5&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class Selector &lt; ActiveRecord::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
        <div class="source_table" id="4ad2671417f75bde415b170275993a4f54a7eb0a">
  <div class="header">
    <h3>app/models/user.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre class="code ruby"><code class="ruby">
    &lt;ol&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;1&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @author Bruno Gardin &lt;bgardin@gmail.com&gt;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;2&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# @copyright GNU GENERAL PUBLIC LICENSE&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;3&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;#   Version 3, 29 June 2007&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;4&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# **User model** used by devise gem.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;5&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# Include default devise modules + :confirmable, :lockable  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;6&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;# User must have a role. They may have invoicing_ledger_item.  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;7&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;class User &lt; ActiveRecord::Base&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;8&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;9&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  validates_presence_of :name  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;10&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  devise :database_authenticatable, :registerable,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;11&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;         :recoverable, :rememberable, :trackable, :validatable,&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;12&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;         :confirmable, :lockable&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;13&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  belongs_to :role&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;14&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  has_many :invoicing_ledger_item&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;15&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  before_save :assign_role&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;16&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # Role assignment: force *Customer* if nil&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;17&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # @return [role] &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;18&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def assign_role&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;179&quot; data-linenumber=&quot;19&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;179&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    self.role = Role.find_by name: &#39;Customer&#39; if self.role.nil?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;20&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;21&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;22&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # check if role is admin&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;23&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def admin?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2568&quot; data-linenumber=&quot;24&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2568&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    self.role.name == &#39;Admin&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;25&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;26&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  &lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;27&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  # check if role is customer&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;1&quot; data-linenumber=&quot;28&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;1&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;  def customer?&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;covered&quot; data-hits=&quot;2424&quot; data-linenumber=&quot;29&quot;&gt;
          &lt;span class=&quot;hits&quot;&gt;2424&lt;/span&gt;
          
          &lt;code class=&quot;ruby&quot;&gt;    self.role.name == &#39;Customer&#39;&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;30&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;  end&lt;/code&gt;
        &lt;/li&gt;
      
        &lt;li class=&quot;never&quot; data-hits=&quot;&quot; data-linenumber=&quot;31&quot;&gt;
          
          
          &lt;code class=&quot;ruby&quot;&gt;end&lt;/code&gt;
        &lt;/li&gt;
      
    &lt;/ol&gt;
  </code></pre>
</div>
      
      </div>
    </div>
  </body>
</html></div></div>

      <div id="footer">
  Generated on Tue Aug  2 14:42:16 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.2 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>